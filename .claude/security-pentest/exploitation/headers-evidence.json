{
  "category": "security_headers",
  "tested_at": "2026-02-06T22:52:39-05:00",
  "base_url": "http://localhost:3000",
  "findings": [
    {
      "id": "HDR-001",
      "title": "Missing Content-Security-Policy header",
      "status": "confirmed",
      "severity": "high",
      "pages_tested": [
        {
          "url": "http://localhost:3000/",
          "csp_header_present": false
        },
        {
          "url": "http://localhost:3000/admin/backlog",
          "csp_header_present": false
        },
        {
          "url": "http://localhost:3000/api/health",
          "csp_header_present": false
        }
      ],
      "exploit_request": {
        "method": "GET",
        "url": "http://localhost:3000/",
        "headers": {}
      },
      "exploit_response": {
        "status_code": 200,
        "headers_present": [
          "X-Content-Type-Options: nosniff",
          "X-Frame-Options: DENY",
          "X-XSS-Protection: 1; mode=block",
          "Referrer-Policy: strict-origin-when-cross-origin",
          "Permissions-Policy: camera=(), microphone=(), geolocation=(), interest-cohort=()"
        ],
        "headers_missing": ["Content-Security-Policy"]
      },
      "proof_of_concept": "curl -s -D - http://localhost:3000/ -o /dev/null 2>&1 | grep -i 'content-security-policy'",
      "impact_demonstrated": "Application lacks Content-Security-Policy header on all routes. While other security headers (X-Frame-Options, X-XSS-Protection, etc.) are present, CSP provides critical defense against XSS, clickjacking, and code injection attacks. Combined with AUTH-001 (non-httpOnly cookie), this significantly increases XSS risk.",
      "file_location": "next.config.mjs or middleware.ts",
      "remediation": "Add Content-Security-Policy header via Next.js config or middleware. Recommended starter policy:\n\nContent-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https://api.github.com https://*.supabase.co; frame-ancestors 'none';\n\nThen progressively tighten (remove unsafe-inline, unsafe-eval) as application permits.",
      "cwe": "CWE-1021: Improper Restriction of Rendered UI Layers or Frames",
      "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N",
      "references": [
        "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
        "https://cheatsheetseries.owasp.org/cheatsheets/Content_Security_Policy_Cheat_Sheet.html",
        "https://nextjs.org/docs/app/building-your-application/configuring/content-security-policy"
      ]
    },
    {
      "id": "HDR-002",
      "title": "Positive security headers present",
      "status": "informational",
      "severity": "info",
      "headers_found": {
        "X-Content-Type-Options": "nosniff",
        "X-Frame-Options": "DENY",
        "X-XSS-Protection": "1; mode=block",
        "Referrer-Policy": "strict-origin-when-cross-origin",
        "Permissions-Policy": "camera=(), microphone=(), geolocation=(), interest-cohort=()"
      },
      "impact": "Application correctly implements multiple security headers providing defense-in-depth. This is positive and reduces attack surface for clickjacking, MIME-sniffing, and XSS attacks.",
      "note": "X-XSS-Protection is deprecated in modern browsers that support CSP. Once CSP is added, this header can be removed."
    }
  ],
  "summary": {
    "total_tested": 2,
    "confirmed": 1,
    "informational": 1,
    "high_severity": 1,
    "critical_missing_header": "Content-Security-Policy",
    "positive_headers_count": 5
  }
}
